function fileHeader(e){return["/*!",e+" - "+pkg.version,"Copyright \xa9 2011-"+(new Date).getFullYear()+" Caleb Troughton","Licensed under the MIT license.","https://github.com/imakewebthings/waypoints/blog/master/licenses.txt","*/\n"].join("\n")}var gulp=require("gulp"),eslint=require("gulp-eslint"),concat=require("gulp-concat"),uglify=require("gulp-uglify"),rename=require("gulp-rename"),header=require("gulp-header"),footer=require("gulp-footer"),tap=require("gulp-tap"),merge=require("merge-stream"),pkg=require("./package.json"),path=require("path"),jsFiles=["src/**/*.js","test/**/*.js","!test/lib/**/*.js"],shortcutTitles={infinite:"Waypoints Infinite Scroll Shortcut",inview:"Waypoints Inview Shortcut",sticky:"Waypoints Sticky Element Shortcut"};gulp.task("lint",function(){return gulp.src(jsFiles).pipe(eslint(".eslintrc")).pipe(eslint.format())}),gulp.task("build-core",function(){var e=["noframework","jquery","zepto"].map(function(e){var t=["src/waypoint.js","src/context.js","src/group.js","src/adapters/"+e+".js"];return["jquery","zepto"].indexOf(e)>-1&&t.push("src/adapters/jquery-zepto-fn-extension.js"),gulp.src(t).pipe(concat(e+".waypoints.js",{newLine:";"})).pipe(header(fileHeader("Waypoints"))).pipe(footer(";")).pipe(gulp.dest("lib/")).pipe(rename(e+".waypoints.min.js")).pipe(uglify({preserveComments:"some"})).pipe(gulp.dest("lib/"))});return merge.apply(null,e)}),gulp.task("build-shortcuts",function(){return gulp.src(["src/shortcuts/*.js"]).pipe(tap(function(e){var t=path.basename(e.path,".js");e.contents=Buffer.concat([new Buffer(fileHeader(shortcutTitles[t])),e.contents])})).pipe(footer(";")).pipe(gulp.dest("lib/shortcuts/")).pipe(rename(function(e){e.basename+=".min"})).pipe(uglify({preserveComments:"some"})).pipe(gulp.dest("lib/shortcuts/"))}),gulp.task("build-debug",function(){return gulp.src(["src/debug.js"]).pipe(rename("waypoints.debug.js")).pipe(header(fileHeader("Waypoints Debug"))).pipe(footer(";")).pipe(gulp.dest("lib/"))}),gulp.task("build",["build-core","build-shortcuts","build-debug"]),gulp.task("watch",function(){gulp.watch(jsFiles,["lint","build"])}),gulp.task("default",["lint","build","watch"]);