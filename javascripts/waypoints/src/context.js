!function(){"use strict";function t(t){window.setTimeout(t,1e3/60)}function e(t){this.element=t,this.Adapter=i.Adapter,this.adapter=new this.Adapter(t),this.key="waypoint-context-"+o,this.didScroll=!1,this.didResize=!1,this.oldScroll={x:this.adapter.scrollLeft(),y:this.adapter.scrollTop()},this.waypoints={vertical:{},horizontal:{}},t.waypointContextKey=this.key,r[t.waypointContextKey]=this,o+=1,this.createThrottledScrollHandler(),this.createThrottledResizeHandler()}var o=0,r={},i=window.Waypoint,n=window.onload;e.prototype.add=function(t){var e=t.options.horizontal?"horizontal":"vertical";this.waypoints[e][t.key]=t,this.refresh()},e.prototype.checkEmpty=function(){var t=this.Adapter.isEmptyObject(this.waypoints.horizontal),e=this.Adapter.isEmptyObject(this.waypoints.vertical);t&&e&&(this.adapter.off(".waypoints"),delete r[this.key])},e.prototype.createThrottledResizeHandler=function(){function t(){e.handleResize(),e.didResize=!1}var e=this;this.adapter.on("resize.waypoints",function(){e.didResize||(e.didResize=!0,i.requestAnimationFrame(t))})},e.prototype.createThrottledScrollHandler=function(){function t(){e.handleScroll(),e.didScroll=!1}var e=this;this.adapter.on("scroll.waypoints",function(){e.didScroll&&!i.isTouch||(e.didScroll=!0,i.requestAnimationFrame(t))})},e.prototype.handleResize=function(){i.Context.refreshAll()},e.prototype.handleScroll=function(){var t={},e={horizontal:{newScroll:this.adapter.scrollLeft(),oldScroll:this.oldScroll.x,forward:"right",backward:"left"},vertical:{newScroll:this.adapter.scrollTop(),oldScroll:this.oldScroll.y,forward:"down",backward:"up"}};for(var o in e){var r=e[o],i=r.newScroll>r.oldScroll,n=i?r.forward:r.backward;for(var l in this.waypoints[o]){var a=this.waypoints[o][l],s=r.oldScroll<a.triggerPoint,d=r.newScroll>=a.triggerPoint,c=s&&d,h=!s&&!d;(c||h)&&(a.queueTrigger(n),t[a.group.id]=a.group)}}for(var p in t)t[p].flushTriggers();this.oldScroll={x:e.horizontal.newScroll,y:e.vertical.newScroll}},e.prototype.innerHeight=function(){return this.element==this.element.window?i.viewportHeight():this.adapter.innerHeight()},e.prototype.remove=function(t){delete this.waypoints[t.axis][t.key],this.checkEmpty()},e.prototype.innerWidth=function(){return this.element==this.element.window?i.viewportWidth():this.adapter.innerWidth()},e.prototype.destroy=function(){var t=[];for(var e in this.waypoints)for(var o in this.waypoints[e])t.push(this.waypoints[e][o]);for(var r=0,i=t.length;r<i;r++)t[r].destroy()},e.prototype.refresh=function(){var t,e=this.element==this.element.window,o=e?void 0:this.adapter.offset(),r={};this.handleScroll(),t={horizontal:{contextOffset:e?0:o.left,contextScroll:e?0:this.oldScroll.x,contextDimension:this.innerWidth(),oldScroll:this.oldScroll.x,forward:"right",backward:"left",offsetProp:"left"},vertical:{contextOffset:e?0:o.top,contextScroll:e?0:this.oldScroll.y,contextDimension:this.innerHeight(),oldScroll:this.oldScroll.y,forward:"down",backward:"up",offsetProp:"top"}};for(var n in t){var l=t[n];for(var a in this.waypoints[n]){var s,d,c,h,p,f=this.waypoints[n][a],w=f.options.offset,u=f.triggerPoint,y=0,g=null==u;f.element!==f.element.window&&(y=f.adapter.offset()[l.offsetProp]),"function"==typeof w?w=w.apply(f):"string"==typeof w&&(w=parseFloat(w),f.options.offset.indexOf("%")>-1&&(w=Math.ceil(l.contextDimension*w/100))),s=l.contextScroll-l.contextOffset,f.triggerPoint=y+s-w,d=u<l.oldScroll,c=f.triggerPoint>=l.oldScroll,h=d&&c,p=!d&&!c,!g&&h?(f.queueTrigger(l.backward),r[f.group.id]=f.group):!g&&p?(f.queueTrigger(l.forward),r[f.group.id]=f.group):g&&l.oldScroll>=f.triggerPoint&&(f.queueTrigger(l.forward),r[f.group.id]=f.group)}}return i.requestAnimationFrame(function(){for(var t in r)r[t].flushTriggers()}),this},e.findOrCreateByElement=function(t){return e.findByElement(t)||new e(t)},e.refreshAll=function(){for(var t in r)r[t].refresh()},e.findByElement=function(t){return r[t.waypointContextKey]},window.onload=function(){n&&n(),e.refreshAll()},i.requestAnimationFrame=function(e){var o=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||t;o.call(window,e)},i.Context=e}();